
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Lecture%208/">
      
      
        <link rel="next" href="../cache%20thrashing/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../feed_rss_updated.xml">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Lecture 9 - obsidian-mkdocs template</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#and-openmp" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="obsidian-mkdocs template" class="md-header__button md-logo" aria-label="obsidian-mkdocs template" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            obsidian-mkdocs template
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lecture 9
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="obsidian-mkdocs template" class="md-nav__button md-logo" aria-label="obsidian-mkdocs template" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    obsidian-mkdocs template
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Abdul's Notes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ECS%20158%20-%20Programming%20on%20Parallel%20Architectures/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ECS 158   Programming on Parallel Architectures
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../GPU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GPU
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 1
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%2012/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Latency, Throughput, Dependencies, etc...
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%202/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 2
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%203/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 3
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%204/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 4
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%205/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Channels in Go
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%206/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 6
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%207/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 7
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Lecture%208/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lecture 8
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Lecture 9
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Lecture 9
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#and-openmp" class="md-nav__link">
    <span class="md-ellipsis">
      $ and OpenMP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="$ and OpenMP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-way-to-think-of-these-states" class="md-nav__link">
    <span class="md-ellipsis">
      Easy way to think of these states:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idea-behind-the-states" class="md-nav__link">
    <span class="md-ellipsis">
      Idea behind the states:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state-transition-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      State Transition Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#this-introduces-a-new-type-of-cache-miss-a-coherency-miss" class="md-nav__link">
    <span class="md-ellipsis">
      This introduces a new type of cache miss, a coherency miss:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="This introduces a new type of cache miss, a coherency miss:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaways...
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analogy-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy ~ Notebooks!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmp" class="md-nav__link">
    <span class="md-ellipsis">
      OpenMP
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache%20thrashing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cache thrashing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../interrupt%20handler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interrupt handler
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../poisoned/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Poisoned
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../queue/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Queue
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_18" >
        
          
          <label class="md-nav__link" for="__nav_18" id="__nav_18_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_18">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../blog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#and-openmp" class="md-nav__link">
    <span class="md-ellipsis">
      $ and OpenMP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="$ and OpenMP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#easy-way-to-think-of-these-states" class="md-nav__link">
    <span class="md-ellipsis">
      Easy way to think of these states:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idea-behind-the-states" class="md-nav__link">
    <span class="md-ellipsis">
      Idea behind the states:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#state-transition-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      State Transition Diagram
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#this-introduces-a-new-type-of-cache-miss-a-coherency-miss" class="md-nav__link">
    <span class="md-ellipsis">
      This introduces a new type of cache miss, a coherency miss:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="This introduces a new type of cache miss, a coherency miss:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#takeaways" class="md-nav__link">
    <span class="md-ellipsis">
      Takeaways...
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analogy-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      Analogy ~ Notebooks!
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#openmp" class="md-nav__link">
    <span class="md-ellipsis">
      OpenMP
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h2 id="and-openmp">$ and OpenMP<a class="headerlink" href="#and-openmp" title="Permanent link">&para;</a></h2>
<p>Every processor needs to have the same view of memory. Every thread shares the same view of memory!</p>
<p>If a processor does a write, it has to let <strong>all</strong> of the other processors know. Invalidate the other copies. (Race Conditions only happen on writes). If we are only reading, many processors can have copies of said data. All of the other processors will 'snoop' on the interconnect and see any requests that go on the interconnect (i.e, usually a BUS) and see if it involves them in any way.  We never want all the writes to go back out to main memory, this is incredibly slow. This motivates us to have something called a write-back cache. Yeah, write-back is a jolly good fellow 😎</p>
<p>We also don't want to do a lot of writing in general. Even when using the write-back method. We can communicate by broadcasting requests. Using the bus allows us to communicate with the neighboring caches from the other processor / cores. </p>
<p>Cache Optimization via these two new states:
3. Exclusive: up-to-date data, no other cache has a copy,  OK to write, memory is up to date
    1. Only the Valid bit is set. 
4. Owner: up to date data, other caches may have a copy, but within the other caches, it must be in the shared state! Main Memory is not up to date. </p>
<h3 id="easy-way-to-think-of-these-states">Easy way to think of these states:<a class="headerlink" href="#easy-way-to-think-of-these-states" title="Permanent link">&para;</a></h3>
<p>For the <strong><em>exclusive</em></strong> state, I found it the easiest to think of it like this:
“I have the <em>only</em> copy, it matches memory, and I can quietly turn it into a Modified copy whenever I want.”</p>
<p>For the <strong><em>owner state</em></strong>, a mental model:
“Others can read from my data, but memory doesn’t know what’s up. If anyone needs the latest data, they come to me.”</p>
<h3 id="idea-behind-the-states">Idea behind the states:<a class="headerlink" href="#idea-behind-the-states" title="Permanent link">&para;</a></h3>
<ul>
<li>M: Modified<ul>
<li>I have the only copy, and can write, and it's dirty</li>
<li>If this gets evicted, I need to flush the entry</li>
</ul>
</li>
<li>O: Owned<ul>
<li>I have the official copy, and can write, and it's dirty</li>
<li>When writing, I have to tell everyone</li>
<li>else I'm writing (And now the state will turn into Modified)</li>
</ul>
</li>
<li>E: Exclusive<ul>
<li>I have the only copy</li>
</ul>
</li>
<li>S: Shared<ul>
<li>I have a copy and can read away</li>
</ul>
</li>
<li>I: Invalid<ul>
<li>Duh, what do you think this means?</li>
</ul>
</li>
</ul>
<p>Weaver does a walk-through of what it looks like when each of the CPU cores wants to do an access for some data at a designated memory address w/ the cache coherency model.</p>
<h2 id="state-transition-diagram">State Transition Diagram<a class="headerlink" href="#state-transition-diagram" title="Permanent link">&para;</a></h2>
<p><img alt="Screenshot 2025-05-04 at 2.20.07 PM.png" src="../screenshots/Screenshot%202025-05-04%20at%202.20.07%20PM.png" /></p>
<p>High-level understanding:
- All blocks start at the INVALID state, and transition throughout this diagram accordingly
- Probe means that another Processor is asking for thingy
Only one of the caches can have a block set as <code>Owner</code></p>
<h1 id="this-introduces-a-new-type-of-cache-miss-a-coherency-miss">This introduces a new type of cache miss, a <code>coherency</code> miss:<a class="headerlink" href="#this-introduces-a-new-type-of-cache-miss-a-coherency-miss" title="Permanent link">&para;</a></h1>
<p>If two CPU's are reading the same data, there is no problem at all. But, if one thread writes the data it will cause evictions from the other thread's cache. 
It does not even need to occur with the specific same piece of data, it just has to be on the same cache line. If one processor is writing to the beginning of the cache line, and the other processor is reading to the beginning of the cache line, then the entire cache line is trashed. </p>
<p>When it comes to multithreaded cores, capacity misses increase due to issues like incoherency.
Incoherency occurs when we read or write different data. There is cache pressure that is being increased. This is still an issue!</p>
<h3 id="takeaways">Takeaways...<a class="headerlink" href="#takeaways" title="Permanent link">&para;</a></h3>
<p>Have each core work on separate pieces of data. Keep the data separate on a reasonable block size (256B will always be safe). Size for a cache about 1/2 of the actual size of the cache (if you face multithreaded CPU's)</p>
<p>You want your working set to be half of what the actual cache size is. You also want <code>writes</code> that take place to be on disjoint boundaries. (i.e, What this means is that you do not one thread's writes to be in a place where another thread will be reading from. you want things to be separated effectively). </p>
<p>What is<a href="../cache%20thrashing/">cache thrashing</a>?</p>
<p>If there are multiple threads accessing the same cache, they are essentially putting capacity pressure on each other. This is not good whatsoever.</p>
<h2 id="analogy-notebooks">Analogy ~ Notebooks!<a class="headerlink" href="#analogy-notebooks" title="Permanent link">&para;</a></h2>
<p>Imagine that you and your friend (You are both CPUs/Cores), are both using a whiteboard (shared whiteboard) to keep track of each of your to-do lists. To save time, we each keep a little notebook (our respective caches), where we will copy the latest version of the information on the whiteboard. If the friend adds something to the to-do list, then we are gonna have to update our little notebook with what they added. This is b/c we still have the old version of what was on the whiteboard. Our system has to evict (erase) our old notebook page / update it so that we both agree. 
<img alt="Screenshot 2025-05-04 at 4.56.52 PM.png" src="../screenshots/Screenshot%202025-05-04%20at%204.56.52%20PM.png" />
For multithreaded cores, imagine that you and your friend share the same notebook, oof, we won't be able to keep track of all of these changes. There will be a lot of capacity misses, this is because the notebook cannot hold everything that we want it to hold.</p>
<p>Capacity pressure → Capacity miss
If that capacity pressure is <em>because threads are using different working sets</em> 
→ Professor calls that an "incoherency miss".</p>
<h1 id="openmp">OpenMP<a class="headerlink" href="#openmp" title="Permanent link">&para;</a></h1>
<p>Language extension used for multi-threaded, shared memory parallelism. </p>
<p>Key ideas:
- shared vs. private variables</p>
<p>Modeled around the fork-join model.</p>
<p><img alt="Screenshot 2025-05-04 at 4.59.26 PM.png" src="../screenshots/Screenshot%202025-05-04%20at%204.59.26%20PM.png" /></p>
<p>OpenMP begins as a single process (master thread), and it will execute sequentially until the very first parallel region construct is encountered. The <code>master</code> thread waits for all the worker threads to be done, and then, we join all of the threads together when we are done with the said parallel region. </p>
<p><strong><em>FORK</em></strong>: Master thread creates a team of parallel threads</p>
<p><strong><em>JOIN</em></strong>: When the team threads complete the statements in the parallel region construct, they synchronize and terminate, leaving only the master thread. </p>
<p>Threads don't <strong><em>die</em></strong>, they go to <em>sleep</em>.</p>
<p><strong>Pragmas</strong> are a preprocessor mechanism C provides for language extensions. </p>
<p>Good parallel code will still be able to run in a sequential system. </p>
<div class="highlight"><pre><span></span><code><span class="cp">#pragma omp parallel</span>
<span class="p">{</span>
<span class="w">    </span><span class="cm">/* code goes here*/</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
        <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
      
    
  </body>
</html>